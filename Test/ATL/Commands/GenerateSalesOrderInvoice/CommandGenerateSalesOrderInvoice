/// <summary>
/// Class: CommandGenerateSalesOrderInvoice
/// Description:
/// Command class for generating a sales order invoice
/// </summary>
internal class CommandGenerateSalesOrderInvoice extends AtlCommand implements ICommandGenerateSalesOrderInvoice
{
    private AtlEntitySalesOrder localEntitySalesOrder;
    private SalesUpdate localSalesUpdate;
    private AccountOrder localAccountOrder;
    private boolean localProforma;
    private boolean localPrintFormLetter;
    private TransDate localTransDate;

    /// <summary>
    /// Create a new class instance.
    /// </summary>
    protected void new()
    {
        localSalesUpdate = SalesUpdate::All;
        localAccountOrder = AccountOrder::None;
        localProforma = false;
        localPrintFormLetter = false;
        localTransDate = DateTimeUtil::getSystemDate(DateTimeUtil::getUserPreferredTimeZone());
    }

    /// <summary>
    /// Creates and returns a new class instance.
    /// </summary>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public static CommandGenerateSalesOrderInvoice construct()
    {
        return new CommandGenerateSalesOrderInvoice();
    }

    /// <summary>
    /// Set SalesUpdate parameter value
    /// </summary>
    /// <param name = "_salesUpdate">SalesUpdate</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forSalesUpdate(
        SalesUpdate _salesUpdate)
    {
        localSalesUpdate = _salesUpdate;
        return this;
    }

    /// <summary>
    /// Set AtlEntitySalesOrder parameter value
    /// </summary>
    /// <param name = "_entitySalesOrder">AtlEntitySalesOrder</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forEntitySalesOrder(
        AtlEntitySalesOrder _entitySalesOrder)
    {
        localEntitySalesOrder = _entitySalesOrder;
        return this;
    }

    /// <summary>
    /// Set SalesTable parameter value
    /// </summary>
    /// <param name = "_salesTable">SalesTable</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forSalesOrder(
        SalesTable _salesTable)
    {
        localEntitySalesOrder = AtlEntitySalesOrder::newFromRecord(_salesTable);
        return this;
    }

    /// <summary>
    /// Set AccountOrder parameter value
    /// </summary>
    /// <param name = "_accountOrder">AccountOrder</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forAccountOrder(
        AccountOrder _accountOrder)
    {
        localAccountOrder = _accountOrder;
        return this;
    }

    /// <summary>
    /// Set Proforma parameter value
    /// </summary>
    /// <param name = "_proforma">boolean</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forProforma(
        boolean _proforma)
    {
        localProforma = _proforma;
        return this;
    }

    /// <summary>
    /// Set PrintFormLetter parameter value
    /// </summary>
    /// <param name = "_printFormLetter">boolean</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forPrintFormLetter(boolean _printFormLetter)
    {
        localPrintFormLetter = _printFormLetter;
        return this;
    }

    /// <summary>
    /// Set TransDate parameter value
    /// </summary>
    /// <param name = "_transDate">TransDate</param>
    /// <returns>CommandGenerateSalesOrderInvoice</returns>
    public CommandGenerateSalesOrderInvoice forTransDate(TransDate _transDate)
    {
        localTransDate = _transDate;
        return this;
    }

    /// <summary>
    /// Executes the business logic.
    /// </summary>
    protected void executeTask()
    {
        SalesFormLetter::construct(
                DocumentStatus::Invoice)
            .update(
                localEntitySalesOrder.record(),
                localTransDate,
                localSalesUpdate,
                localAccountOrder,
                localProforma,
                localPrintFormLetter);
    }
}
